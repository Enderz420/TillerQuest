// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

// prisma/schema.prisma
datasource db {
  provider  = "postgresql"
  url  	    = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

enum UserRole {
  NEW
  USER
  ADMIN
}

enum Class {
  Warrior
  Mage
  Rogue
  Hunter
  Priest
  Shaman
  Warlock
  Druid
  Paladin
  Deathknight
}

model User {
  id            String    @id @default(cuid())
  name          String?
  lastname      String?
  email         String?   @unique
  username      String?   @unique
  title         String?   @default("Newborn")
  class         Class?
  image         String?
  level         Int       @default(1)
  xp            Int       @default(1)
  hp            Int       @default(40)
  hpMax         Int       @default(40)
  mana          Int       @default(4)
  manaMax       Int       @default(40)
  runes         Int       @default(1)
  gold          Int       @default(0)
  abilities     Ability[] // A user can have many abilities
  clanId        Int?
  emailVerified DateTime?
  role          UserRole   @default(NEW) // A new user starts with role NEW, then changes to USER
  accounts      Account[] // Relation to Github account

  clan          Clan?       @relation(fields: [clanId], references: [id], onUpdate: Cascade, onDelete: Cascade)
}

// Github account
model Account {
  id                 String  @id @default(cuid())
  userId             String
  type               String
  provider           String
  providerAccountId  String
  refresh_token      String?  @db.Text
  access_token       String?  @db.Text
  expires_at         Int?
  token_type         String?
  scope              String?
  id_token           String?  @db.Text
  session_state      String?

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
}

model Ability {
  id               Int @id @default(autoincrement())
  name             String
  description      String
  cost             Int
  user             User[] // An ability can belong to many users ????
}

model Clan {
  id              Int @id @default(autoincrement())
  name            String @unique
  members         User[] 
}

model CosmicEvent {
  id              Int @id @default(autoincrement())
  name            String @unique
  description     String
  date            DateTime?
}


// npx prisma generate
// npx prisma db push

//npx prisma studio